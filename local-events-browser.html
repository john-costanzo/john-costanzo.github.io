<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/x-icon" href="images/event-browser-icon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HXEY2N6DY2"></script>
    <script>
        window.dataLayer = window.dataLayer || [ ];

        function gtag( ) {
            dataLayer.push( arguments );
        }
        gtag( 'js', new Date( ) );

        gtag( 'config', 'G-HXEY2N6DY2' );
    </script>

    <script>
        var lookahead_days = 28;
        // Current date and date formatting utility
        const today = new Date( );
        const endDate = new Date( today );
        endDate.setDate( today.getDate( ) + lookahead_days );
    </script>

    <script src="js/event-data.js"></script>
    <script src="js/add-event-to-calendar.js"></script>
    <script src="js/event-utils.js"></script>
    <link rel="stylesheet" href="css/add-event-to-calendar.css" media="screen" />

    <script>
        const reload_period_ms = 8 * 60 * 60 * 1000; // 8 hours in milliseconds
        var venueFilters = [ ]; // array of names of currently selected venues
    </script>

    <title>Hendo Happenings</title>
    <script>
        const localEventBrowserVersion = "Friday, 2025-08-08 @ 18:42:24";
        console.log( `localEventBrowserVersion = ${localEventBrowserVersion}` );
    </script>
    <style>
        body {
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.1;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
        }

        header {
            text-align: center;
            margin-bottom: 0px;
            border-bottom: 2px solid #3a6ea5;
            padding-bottom: 0px;
        }

        h1 {
            color: white;
            margin-top: 0px;
            margin-bottom: 0px;
            font-size: 1.5em;
            line-height: 0.1;
        }

        .date-container {
            margin-bottom: 10px;
            background-color: white;
            border-radius: 8px;
            padding-top: 10px;
            padding-left: 10px;
            padding-right: 10px;
            padding-bottom: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        h2 {
            color: #3a6ea5;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
            margin-top: -10px;
            margin-bottom: -5px;
            font-size: 1.1em;
        }

        h3 {
            margin-top: 0px;
            margin-bottom: 0px;
        }

        .event {
            padding-bottom: 5px;
            padding-top: 5px;
            padding-left: 5px;
            padding-right: 15px;
            border-left: 4px solid #6c9ece;
            background-color: #f5f8fa;
            border-radius: 0 4px 4px 0;
            margin-bottom: 0px;
        }

        /* Apply margin-bottom: 5px ONLY to the last .event in its parent */
        .event:last-child {
            margin-bottom: 5px;
        }

        .event>.venue {
            margin-top: 0px;
        }

        .event:hover {
            background-color: #e9f0f7;
        }

        .venue {
            font-weight: bold;
            color: #d35400;
            line-height: 1.3;
        }

        .time {
            color: #666;
            padding-left: 10px;
            font-style: italic;
            line-height: 1.3;
        }

        .event-name {
            font-weight: 500;
            margin-top: 5px;
            line-height: 1.3;
        }

        .event-description {
            font-weight: 500;
            margin-top: 5px;
        }

        .toggle-control {
            font-weight: 500;
            margin-left: 10px;
            margin-top: 5px;
            margin-right: 3px;
            line-height: 1.3;
        }

        .hidden {
            display: none;
            line-height: 1.3;
        }

        .info {
            background-color: #e9f7ef;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            border-left: 4px solid #27ae60;
        }

        #loading {
            text-align: center;
            padding: 30px;
            font-size: 18px;
        }

        .error {
            background-color: #fdedec;
            color: #c0392b;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }

        .filter-controls {
            margin-bottom: 20px;
            padding: 15px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .filter-controls label {
            margin-right: 15px;
        }

        select,
        input {
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }

        button {
            background-color: #3a6ea5;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
        }

        button:hover {
            background-color: #2c5282;
        }

        .venue-chip {
            display: inline-block;
            padding: 3px 8px;
            margin-right: 5px;
            margin-bottom: 5px;
            background-color: #e9f0f7;
            border-radius: 15px;
            font-size: 0.8rem;
            cursor: pointer;
        }

        .venue-chip.active {
            background-color: #3a6ea5;
            color: white;
        }

        .no-events {
            text-align: center;
            padding: 30px;
            font-style: italic;
            color: white;
        }

        .green {
            color: green;
            border-color: green;
        }

        .red {
            color: red;
            border-color: red;
        }

        .date-range {
            line-height: 0.7;
        }
    </style>
</head>

<body>
    <header>
        <h1>Hendo Happenings</h1>
        <p class="date-range">
            Events for: <span id="date-range"></span>
        </p>
    </header>

    <div class="filter-controls">
        <h3>Filter Events <span id="event_count"></span></h3>
        <label>
            <input type="text" id="search-input" placeholder="Search events..." />
        </label>
        <span style="margin-bottom: 8px">Venues:</span>
        <span id="venue-toggle" class="toggle-control green">⊕</span>
        <span id="venue-filters" style="margin-top: 15px" class="hidden">
            <!-- Venue chips will be generated here -->
        </span>
    </div>

    <script>
        const venue_toggle = document.getElementById( "venue-toggle" );
        const venue_filters = document.getElementById( "venue-filters" );
        venue_toggle.addEventListener( "click", function( ) {
            venue_filters.classList.toggle( "hidden" );
            if ( venue_toggle.textContent === "⊕" ) {
                venue_toggle.textContent = "Θ";
                venue_toggle.className = "toggle-control red";
            } else {
                venue_toggle.textContent = "⊕";
                venue_toggle.className = "toggle-control green";
            }
        } );
    </script>

    <!-- <div class="info"> -->
    <!--     <p>This guide shows entertainment events at various local establishments for the next four weeks. Events are organized by date.</p> -->
    <!-- </div> -->

    <div id="loading">Loading events, please wait...</div>

    <div id="events-container"></div>

    <script>
        document.getElementById( "date-range" ).textContent =
            `${formatDate(today)} - ${formatDate(future_date)}`;

        // Initialize the page
        window.addEventListener( "DOMContentLoaded", ( ) => {
            // Setup search functionality
            document
                .getElementById( "search-input" )
                .addEventListener( "input", ( e ) => {
                    applyFilters( );
                    const searchTerm = document
                        .getElementById( "search-input" )
                        .value.toLowerCase( );
                } );
            createVenueFilters( );
            applyURLParameters( );

            // Hide loading message
            document.getElementById( "loading" ).style.display = "none";

            // Show initial events
            const organizedEvents = organizeEventsByDate(
                events,
                getLocalISODateString( today ).split( "T" )[ 0 ],
                getLocalISODateString( endDate ).split( "T" )[ 0 ],
            );
            applyFilters( );

            // TODO: why does calling the following line (admittedly unnecessarily since applyFilters() calls it) show events that are not filtered by venue?
            // renderEvents( organizedEvents, true );
        } );
    </script>
</body>

</html>

<!-- Local Variables: -->
<!-- time-stamp-line-limit: 50 -->
<!-- time-stamp-format: "%A, %Y-%02m-%02d @ %02H:%02M:%02S" -->
<!-- time-stamp-active: t -->
<!-- time-stamp-start: "const localEventBrowserVersion = \"" -->
<!-- time-stamp-end: "\";" -->
<!-- End: -->
